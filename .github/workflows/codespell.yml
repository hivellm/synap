name: Codespell

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  codespell:
    name: Check Spelling
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Install codespell
        run: pip install codespell

      - name: Run codespell
        run: |
          codespell \
            --skip=".git,.github,target,node_modules,*.lock,*.toml,data,*.wal" \
            --ignore-words=.codespellignore \
            --quiet-level=2 \
            docs/ \
            synap-server/src/ \
            synap-cli/src/ \
            README.md \
            CHANGELOG.md \
            scripts/ \
            tests/ \
            sdks/ \
            || true

  markdown-lint:
    name: Markdown Lint
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install markdownlint-cli
        run: npm install -g markdownlint-cli

      - name: Run markdownlint
        run: |
          markdownlint \
            --ignore node_modules \
            --ignore target \
            --config .markdownlint.json \
            '**/*.md' \
            || true
        continue-on-error: true

  typos:
    name: Typos Check
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install typos
        uses: taiki-e/install-action@typos

      - name: Run typos
        run: typos --format brief
        continue-on-error: true

