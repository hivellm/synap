# Synap Server Configuration Example
# Copy this file to config.yml and adjust as needed

# ============================================================================
# NETWORK
# ============================================================================

server:
  host: "0.0.0.0"
  port: 15500
  websocket_enabled: false

# ============================================================================
# MEMORY MANAGEMENT (Redis-compatible)
# ============================================================================

kv_store:
  # Memory limit (Redis maxmemory equivalent)
  # Common values:
  #   256   -> 256MB (small cache)
  #   1024  -> 1GB (medium cache)
  #   4096  -> 4GB (large cache)
  #   8192  -> 8GB (very large cache)
  max_memory_mb: 4096
  
  # Eviction policy (Redis maxmemory-policy equivalent)
  # Options: lru, lfu, ttl, none
  eviction_policy: "lru"
  
  # TTL cleanup frequency
  ttl_cleanup_interval_ms: 100

# ============================================================================
# LOGGING
# ============================================================================

logging:
  # Log level: trace, debug, info, warn, error
  level: "info"
  
  # Log format: json, pretty
  format: "json"

# ============================================================================
# PROTOCOLS
# ============================================================================

protocols:
  streamable_http:
    enabled: true
    path: "/api/v1/command"
  
  rest:
    enabled: true
    prefix: "/kv"

# ============================================================================
# MCP (Model Context Protocol) TOOLS
# ============================================================================

# Configure which MCP tool categories to expose
# Note: Cursor has limits on the number of MCP tools it can handle efficiently
# Default: Only essential tools (KV + Queue = 4 tools total)
# Maximum: All categories enabled = 16 tools

mcp:
  # KV Tools (3 tools): synap_kv_get, synap_kv_set, synap_kv_delete
  # Essential - recommended to keep enabled
  enable_kv_tools: true
  
  # Hash Tools (3 tools): synap_hash_get, synap_hash_set, synap_hash_getall
  enable_hash_tools: false
  
  # List Tools (3 tools): synap_list_push, synap_list_pop, synap_list_range
  enable_list_tools: false
  
  # Set Tools (3 tools): synap_set_add, synap_set_members, synap_set_inter
  enable_set_tools: false
  
  # Queue Tools (1 tool): synap_queue_publish
  # Essential - recommended to keep enabled
  enable_queue_tools: true
  
  # Sorted Set Tools (3 tools): synap_sortedset_zadd, synap_sortedset_zrange, synap_sortedset_zrank
  enable_sortedset_tools: false

# Note: All functionality is available via REST API and StreamableHTTP
# regardless of MCP tool configuration

# ============================================================================
# AUTHENTICATION & SECURITY
# ============================================================================

auth:
  # Enable/disable authentication
  # Default: false (disabled for development)
  # IMPORTANT: Authentication is REQUIRED when binding to 0.0.0.0
  enabled: false
  
  # Require authentication for all endpoints
  # If false, anonymous access is allowed (with limited permissions)
  # Default: false
  require_auth: false
  
  # Root user configuration (created on first startup)
  # CHANGE THESE IN PRODUCTION!
  root:
    username: "root"
    password: "root"  # MUST be changed in production!
    enabled: true     # Can be disabled after initial setup for security
  
  # Default TTL for temporary API keys (in seconds)
  # Default: 3600 (1 hour)
  default_key_ttl: 3600

# Environment Variables (Docker):
#   SYNAP_AUTH_ENABLED=true
#   SYNAP_AUTH_REQUIRE_AUTH=true
#   SYNAP_AUTH_ROOT_USERNAME=root
#   SYNAP_AUTH_ROOT_PASSWORD=your_secure_password
#   SYNAP_AUTH_ROOT_ENABLED=true
#   SYNAP_AUTH_DEFAULT_KEY_TTL=3600

